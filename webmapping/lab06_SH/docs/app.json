[{"name":"App.R","content":"library(shiny)\r\nlibrary(leaflet)\r\nlibrary(sf)\r\nlibrary(dplyr)\r\n\r\ngetwd()\r\n\r\npoints_data <- st_read('C:\\\\Users\\\\miiin\\\\Downloads\\\\Week07_shiny\\\\Week07_shiny\\\\cbsa_points.shp')\r\ntf_data <- st_transform(points_data, crs = '+proj=longlat +datum=WGS84')\r\n\r\nui <- fluidPage(\r\n  titlePanel('Housing Mortgage Map'),\r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      sliderInput(inputId = 'mortgagerange',\r\n                  label = 'Mortgage Range',\r\n                  min = 0,\r\n                  max = max(tf_data$Mortgage, na.rm = TRUE),\r\n                  value = c(0, max(tf_data$Mortgage, na.rm = TRUE))),\r\n      selectizeInput(inputId = 'stateFilter',\r\n                     label = 'Select State',\r\n                     choices = unique(tf_data$State),\r\n                     selected = unique(tf_data$State)[1],\r\n                     multiple = TRUE),\r\n      radioButtons(inputId = 'displayOption',\r\n                   label = 'Display Options',\r\n                   choices = list('All' = 'all', 'Filter' = 'filter'),\r\n                   selected = 'filter')\r\n    ),\r\n    mainPanel(\r\n      leafletOutput(outputId = 'map', width = '100%', height = '500px')\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output) {\r\n  filtered_data <- reactive({\r\n    if (input$displayOption == 'all') {\r\n      tf_data\r\n    } else {\r\n      tf_data %>%\r\n        filter(\r\n          Mortgage >= input$mortgagerange[1],\r\n          Mortgage <= input$mortgagerange[2],\r\n          State %in% input$stateFilter\r\n        )\r\n    }\r\n  })\r\n  \r\n  output$map <- renderLeaflet({\r\n    leaflet() %>%\r\n      addTiles() %>%\r\n      setView(lng = mean(st_coordinates(tf_data)[, 1]),\r\n              lat = mean(st_coordinates(tf_data)[, 2]),\r\n              zoom = 6)\r\n  })\r\n  \r\n  observe({\r\n    leafletProxy(\"map\", data = filtered_data()) %>%\r\n      clearMarkers() %>%\r\n      addCircleMarkers(\r\n        radius = 5,\r\n        color = \"blue\",\r\n        label = ~paste(\"Mortgage:\", Mortgage, \"State:\", State)\r\n      )\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n\r\n\r\ninstall.packages('rsconnect')\r\nrsconnect::setAccountInfo(name='miinakova',\r\n                          token='9E399591AAB21620ACA0CB73A1AE040A',\r\n                          secret='6rlAs7bnFmFIlT69dBcts/VSuwR2SOPW0xGS5EDn')\r\nlibrary(rsconnect)\r\nrsconnect::deployApp('C:/Users/miiin/Downloads/Week07_shiny/Week07_shiny')\r\n","type":"text"}]
